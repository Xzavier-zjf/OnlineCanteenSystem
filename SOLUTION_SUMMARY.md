# ğŸ¯ é£Ÿå ‚è®¢é¤ç³»ç»Ÿ - 500/502é”™è¯¯è§£å†³æ–¹æ¡ˆ

## ğŸ” é—®é¢˜æ€»ç»“
å‰ç«¯æ˜¾ç¤º500/502å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ï¼Œæ‰€æœ‰APIè¯·æ±‚å¤±è´¥ï¼ŒåŒ…æ‹¬ç™»å½•ã€å•†å“åˆ—è¡¨ã€è®¢å•ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. å¾®æœåŠ¡é…ç½®ç»Ÿä¸€
- **ç¦ç”¨NacosæœåŠ¡å‘ç°**ï¼šç»Ÿä¸€è®¾ç½®æ‰€æœ‰æœåŠ¡çš„`nacos.discovery.enabled=false`
- **ä¿®å¤Spring Bootç½‘å…³**ï¼šæ³¨é‡Š`@EnableDiscoveryClient`é¿å…å¯åŠ¨å†²çª
- **æ•°æ®åº“è¿æ¥æ­£å¸¸**ï¼šæ‰€æœ‰å¾®æœåŠ¡éƒ½èƒ½æ­£å¸¸è¿æ¥MySQLæ•°æ®åº“

### 2. åˆ›å»ºNode.jsç½‘å…³
- **æ›¿ä»£Spring Bootç½‘å…³**ï¼šä½¿ç”¨Express + http-proxy-middleware
- **è·¯å¾„é‡å†™é€»è¾‘**ï¼šå¤„ç†å‰ç«¯åŒé‡è·¯å¾„é—®é¢˜ï¼ˆ/api/users/users -> /api/usersï¼‰
- **CORSé…ç½®**ï¼šå®Œå…¨å¼€æ”¾è·¨åŸŸè®¿é—®
- **è¯¦ç»†æ—¥å¿—**ï¼šæä¾›å®Œæ•´çš„è¯·æ±‚ä»£ç†æ—¥å¿—

### 3. æœåŠ¡çŠ¶æ€éªŒè¯
- âœ… **ç”¨æˆ·æœåŠ¡** (8081) - æ­£å¸¸è¿è¡Œï¼Œå¥åº·æ£€æŸ¥é€šè¿‡
- âœ… **å•†å“æœåŠ¡** (8082) - æ­£å¸¸è¿è¡Œï¼Œå¥åº·æ£€æŸ¥é€šè¿‡  
- âœ… **è®¢å•æœåŠ¡** (8083) - æ­£å¸¸è¿è¡Œï¼Œå¥åº·æ£€æŸ¥é€šè¿‡
- âœ… **æ¨èæœåŠ¡** (8084) - æ­£å¸¸è¿è¡Œï¼Œå¥åº·æ£€æŸ¥é€šè¿‡
- âœ… **ç»ˆæç½‘å…³** (8080) - æ­£å¸¸å¯åŠ¨ï¼Œæ¥æ”¶å‰ç«¯è¯·æ±‚

## ğŸš€ å½“å‰çŠ¶æ€

### ç½‘å…³é…ç½®
```javascript
// è·¯å¾„é‡å†™è§„åˆ™
'^/api/users/users(.*)': '/api/users$1'     // ç”¨æˆ·ç™»å½•ç­‰
'^/api/products/products(.*)': '/api/products$1'  // å•†å“åˆ—è¡¨ç­‰  
'^/api/orders/orders(.*)': '/api/orders$1'   // è®¢å•åˆ—è¡¨ç­‰
```

### æœåŠ¡æ˜ å°„
- ğŸ‘¤ `/api/users` â†’ `http://localhost:8081`
- ğŸ›ï¸ `/api/products` â†’ `http://localhost:8082`
- ğŸ“‹ `/api/orders` â†’ `http://localhost:8083`
- â­ `/api/recommend` â†’ `http://localhost:8084`

## ğŸ“± æµ‹è¯•æ–¹æ³•

### 1. éªŒè¯æœåŠ¡è¿è¡Œ
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr ":808"

# æµ‹è¯•å¾®æœåŠ¡å¥åº·
curl http://localhost:8081/api/users/health
curl http://localhost:8082/api/products/health
curl http://localhost:8083/api/orders/health
```

### 2. æµ‹è¯•å‰ç«¯åŠŸèƒ½
1. **æ‰“å¼€å‰ç«¯**ï¼šhttp://localhost:3001
2. **æµ‹è¯•ç™»å½•**ï¼š
   - ç®¡ç†å‘˜ï¼š`admin` / `admin123`
   - å•†æˆ·ï¼š`merchant` / `admin123`
   - ç”¨æˆ·ï¼š`user1` / `admin123`
3. **æ£€æŸ¥æ§åˆ¶å°**ï¼šåº”è¯¥ä¸å†æ˜¾ç¤º500/502é”™è¯¯

## ğŸ”§ æ•…éšœæ’é™¤

### å¦‚æœä»æœ‰é—®é¢˜ï¼š

1. **é‡å¯ç½‘å…³**ï¼š
   ```bash
   # åœæ­¢å½“å‰ç½‘å…³
   taskkill /f /im node.exe
   
   # å¯åŠ¨ç»ˆæç½‘å…³
   node ultimate_gateway.js
   ```

2. **æ£€æŸ¥å¾®æœåŠ¡**ï¼š
   ```bash
   # é‡å¯æ‰€æœ‰å¾®æœåŠ¡
   cd canteen-user-service && mvn spring-boot:run
   cd canteen-product-service && mvn spring-boot:run
   cd canteen-order-service && mvn spring-boot:run
   ```

3. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**ï¼šåˆ·æ–°é¡µé¢æˆ–ç¡¬åˆ·æ–°ï¼ˆCtrl+F5ï¼‰

## ğŸ‰ é¢„æœŸç»“æœ

ä¿®å¤å®Œæˆåï¼Œå‰ç«¯åº”ç”¨åº”è¯¥èƒ½å¤Ÿï¼š
- âœ… æ­£å¸¸ç™»å½•ï¼ˆä¸å†æ˜¾ç¤º500é”™è¯¯ï¼‰
- âœ… åŠ è½½å•†å“åˆ—è¡¨
- âœ… æ˜¾ç¤ºè®¢å•ä¿¡æ¯
- âœ… æ‰€æœ‰APIè°ƒç”¨æ­£å¸¸å·¥ä½œ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ‰€æœ‰Javaè¿›ç¨‹æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. Node.jsç½‘å…³æ˜¯å¦åœ¨8080ç«¯å£ç›‘å¬
3. MySQLæ•°æ®åº“æœåŠ¡æ˜¯å¦å¯åŠ¨
4. å‰ç«¯Viteå¼€å‘æœåŠ¡å™¨æ˜¯å¦åœ¨3001ç«¯å£è¿è¡Œ

---
**ä¿®å¤å®Œæˆæ—¶é—´**ï¼š2025å¹´9æœˆ7æ—¥  
**ç½‘å…³ç‰ˆæœ¬**ï¼šç»ˆæç‰ˆ (ultimate_gateway.js)  
**çŠ¶æ€**ï¼šâœ… ä¸»è¦åŠŸèƒ½å·²ä¿®å¤ï¼Œç³»ç»Ÿå¯ç”¨